<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>How-To: docker-compose - CUEH ComSec</title><meta name=Description content="The official site of CUEH ComSec - Coventry University's Ethical Hacking Society. Meeting weekly, we plan to use this site to show the progress of the group."><meta property="og:title" content="How-To: docker-compose"><meta property="og:description" content="This year we will be using a lot of docker machines. They are like virtual machines, however slimed down, therefore using less resources and have smaller file sizes. We recommend running docker on your Kali Linux machine (or Debian based distribution), even though it can run on Windows, it can be temperamental at times. Therefore, this is a guide for Linux only.
Installation Firstly, ensure your system is fully up to date, then install the necessary packages."><meta property="og:type" content="article"><meta property="og:url" content="https://cov-comsec.github.io/posts/docker-compose/"><meta property="og:image" content="https://cov-comsec.github.io/logo.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-19T12:40:28+01:00"><meta property="article:modified_time" content="2021-06-22T12:09:00+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cov-comsec.github.io/logo.svg"><meta name=twitter:title content="How-To: docker-compose"><meta name=twitter:description content="This year we will be using a lot of docker machines. They are like virtual machines, however slimed down, therefore using less resources and have smaller file sizes. We recommend running docker on your Kali Linux machine (or Debian based distribution), even though it can run on Windows, it can be temperamental at times. Therefore, this is a guide for Linux only.
Installation Firstly, ensure your system is fully up to date, then install the necessary packages."><meta name=application-name content="CUEH ComSec"><meta name=apple-mobile-web-app-title content="CUEH ComSec"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/CUEH.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://cov-comsec.github.io/posts/docker-compose/><link rel=prev href=https://cov-comsec.github.io/posts/vm_setup/><link rel=next href=https://cov-comsec.github.io/posts/welcome_nmap_writeup/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"How-To: docker-compose","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/cov-comsec.github.io\/posts\/docker-compose\/"},"image":["https:\/\/cov-comsec.github.io\/CUEH.svg"],"genre":"posts","keywords":"Docker, docker-compose, Kali, Guide","wordcount":612,"url":"https:\/\/cov-comsec.github.io\/posts\/docker-compose\/","datePublished":"2020-10-19T12:40:28+01:00","dateModified":"2021-06-22T12:09:00+01:00","publisher":{"@type":"Organization","name":"Jack Orcherton","logo":"https:\/\/cov-comsec.github.io\/CUEH.svg"},"author":{"@type":"Person","name":"Jack Orcherton"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about/>About </a><a class=menu-item href=/galactic/>Galactic CTF </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=https://cueh-comsec.ctfd.io/ rel="noopener noreffer" target=_blank>CTFd </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/galactic/ title>Galactic CTF</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=https://cueh-comsec.ctfd.io/ title rel="noopener noreffer" target=_blank>CTFd</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">How-To: docker-compose</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://jackorcherton.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>Jack Orcherton</a></span>&nbsp;<span class=post-category>included in <a href=/categories/academic-year-2020-21/><i class="far fa-folder fa-fw"></i>Academic Year 2020-21</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-10-19>2020-10-19</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;612 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#installation>Installation</a></li><li><a href=#demonstration>Demonstration</a><ul><li><a href=#finding-the-right-ip>Finding the Right IP</a></li><li><a href=#shutting-down-docker>Shutting Down Docker</a></li></ul></li><li><a href=#troubleshootingcommon-errors>Troubleshooting/Common Errors</a><ul><li><a href=#general-advicetips>General Advice/Tips</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>This year we will be using a lot of docker machines. They are like virtual machines, however slimed down, therefore using less resources and have smaller file sizes. We recommend running docker on your Kali Linux machine (or Debian based distribution), even though it can run on Windows, it can be temperamental at times. Therefore, this is a guide for Linux only.</p><h2 id=installation>Installation</h2><p>Firstly, ensure your system is fully up to date, then install the necessary packages.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ sudo apt update <span class=o>&amp;&amp;</span> sudo apt upgrade
</span></span><span class=line><span class=cl>$ sudo apt install docker.io docker-compose
</span></span></code></pre></td></tr></table></div></div><p>Now all the required software should be downloaded.</p><h2 id=demonstration>Demonstration</h2><p>Next you will need a docker-compose file - this just instructs docker on how to load the correct image. For this demonstration, we will use the file from the first week.</p><p>Below, we firstly create a new folder, download a docker-compose file then run it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ mkdir testDocker
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> testDocker
</span></span><span class=line><span class=cl>$ wget https://cov-comsec.github.io/posts/welcome_nmap/c1/docker-compose.yaml
</span></span><span class=line><span class=cl>$ sudo docker-compose up
</span></span><span class=line><span class=cl>Starting testdocker_ftp_1  ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Starting testdocker_ssh_1  ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Starting testdocker_smtp_1 ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Starting testdocker_web_1  ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Attaching to testdocker_ssh_1, testdocker_web_1, testdocker_smtp_1, testdocker_ftp_1
</span></span><span class=line><span class=cl>ftp_1   <span class=p>|</span> Starting Pure-FTPd:
</span></span><span class=line><span class=cl>ftp_1   <span class=p>|</span>   pure-ftpd  -c <span class=m>30</span> -C <span class=m>10</span> -l puredb:/etc/pure-ftpd/pureftpd.pdb -j -R -P localhost -p 30000:30059
</span></span><span class=line><span class=cl>web_1   <span class=p>|</span> AH00558: apache2: Could not reliably determine the server<span class=s1>&#39;s fully qualified domain name, using 192.168.42.3. Set the &#39;</span>ServerName<span class=s1>&#39; directive globally to suppress this message
</span></span></span><span class=line><span class=cl><span class=s1>web_1   | AH00558: apache2: Could not reliably determine the server&#39;</span>s fully qualified domain name, using 192.168.42.3. Set the <span class=s1>&#39;ServerName&#39;</span> directive globally to suppress this message
</span></span><span class=line><span class=cl>web_1   <span class=p>|</span> <span class=o>[</span>Sun Jun <span class=m>20</span> 23:10:50.635898 2021<span class=o>]</span> <span class=o>[</span>mpm_prefork:notice<span class=o>]</span> <span class=o>[</span>pid 1<span class=o>]</span> AH00163: Apache/2.4.25 <span class=o>(</span>Debian<span class=o>)</span> PHP/7.3.4 configured -- resuming normal operations
</span></span></code></pre></td></tr></table></div></div><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fw"></i>Warning<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Do not close this terminal window (otherwise docker will stop) – just open a new terminal
window.</div></div></div><h3 id=finding-the-right-ip>Finding the Right IP</h3><p>Normally docker should assign itself to localhost (127.0.0.1), however this is not always the case – just have a look at the output from the docker-start command, and it should show you (see the demo above). To be able to attack all services, to complicate matters, you will have to change this IP – change the end number to a 1. E.g., 192.168.42.4 -> 192.168.42.1</p><h3 id=shutting-down-docker>Shutting Down Docker</h3><p>When you have finished & found all the flags (congratulations) go back to the terminal window running docker – press CTRL + C simultaneously. Sometimes this takes a minute or two – wait until all the machines say &lsquo;done&rsquo;.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>^CGracefully stopping... <span class=o>(</span>press Ctrl+C again to force<span class=o>)</span>
</span></span><span class=line><span class=cl>Stopping testdocker_web_1  ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Stopping testdocker_smtp_1 ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Stopping testdocker_ftp_1  ... <span class=k>done</span>
</span></span><span class=line><span class=cl>Stopping testdocker_ssh_1  ... <span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=troubleshootingcommon-errors>Troubleshooting/Common Errors</h2><p>Docker is an amazing piece of software - when it works! Unfortunately, it is prone to errors; here&rsquo;s how to fix the most common:</p><ul><li><strong>Error</strong> - <code>E: Package 'python3-pip' has no installation candidate</code>
Answer: ensure pip is installed <code>apt install pip</code>.</li><li><strong>Error</strong> - <code>Pool overlaps with other one on this address space</code>
Answer: this means that another docker machine/service on your PC is using the same port. This problem can be solved by turning off said docker machine/service and running <code>sudo docker network prune</code>.</li></ul><h3 id=general-advicetips>General Advice/Tips</h3><ul><li>Run the command as sudo.</li><li>Ensure a file named &lsquo;docker-compose.yaml&rsquo; exists in your present working directory.</li><li>Restart docker machines - <code>sudo docker-compose restart</code> (must be run in the same folder as the docker-compose file).</li><li>Run <code>sudo docker-compose kill</code> (must be run in the same folder as the docker-compose file) to force shutdown a machine.</li><li>Try resetting IP addresses - <code>sudo docker network prune</code>.</li><li>Restart VM – surprising what a reboot can do!</li><li>Google the error or look at the man pages (<code>man docker-compose</code>).</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-06-22&nbsp;<a class=git-hash href=https://github.com/Cov-ComSec/Cov-ComSec.github.io/commit/7a17d3da21d05c229d6dc88795865bdcc9436e57 target=_blank title="commit by Jack Orcherton(jackorcherton@outlook.com) 7a17d3da21d05c229d6dc88795865bdcc9436e57: SPaG Check">
<i class="fas fa-hashtag fa-fw"></i>7a17d3d</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/docker-compose/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/docker/>Docker</a>,&nbsp;<a href=/tags/docker-compose/>docker-compose</a>,&nbsp;<a href=/tags/kali/>Kali</a>,&nbsp;<a href=/tags/guide/>Guide</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/vm_setup/ class=prev rel=prev title="Installing Kali Linux on VMware"><i class="fas fa-angle-left fa-fw"></i>Installing Kali Linux on VMware</a>
<a href=/posts/welcome_nmap_writeup/ class=next rel=next title="ComSec Introduction Writeup">ComSec Introduction Writeup<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div>Please ensure all comments adhere to our <strong><a href=/conduct>Code of Conduct!</a></strong><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>CUEH ComSec</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"photon-dark",issueTerm:"pathname",label:"Comments",lightTheme:"github-light",repo:"Cov-ComSec/Cov-ComSec.github.io"}},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>