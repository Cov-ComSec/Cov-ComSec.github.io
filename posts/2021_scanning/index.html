<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Scanning and Enumeration - CUEH ComSec</title><meta name=Description content="A brief introduction to scanning tools and techniques, ending the session with a boot2root challenge"><meta property="og:title" content="Scanning and Enumeration"><meta property="og:description" content="A brief introduction to scanning tools and techniques, ending the session with a boot2root challenge"><meta property="og:type" content="article"><meta property="og:url" content="https://cov-comsec.github.io/posts/2021_scanning/"><meta property="og:image" content="https://cov-comsec.github.io/logo.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-29T22:40:28+01:00"><meta property="article:modified_time" content="2021-11-04T10:34:36+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cov-comsec.github.io/logo.svg"><meta name=twitter:title content="Scanning and Enumeration"><meta name=twitter:description content="A brief introduction to scanning tools and techniques, ending the session with a boot2root challenge"><meta name=application-name content="CUEH ComSec"><meta name=apple-mobile-web-app-title content="CUEH ComSec"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/CUEH.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://cov-comsec.github.io/posts/2021_scanning/><link rel=prev href=https://cov-comsec.github.io/posts/week1_writeup/><link rel=next href=https://cov-comsec.github.io/posts/octalkber/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Scanning and Enumeration","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/cov-comsec.github.io\/posts\/2021_scanning\/"},"image":["https:\/\/cov-comsec.github.io\/CUEH.svg"],"genre":"posts","keywords":"Nmap, CTF, Docker, enumeration, reconnaissance","wordcount":726,"url":"https:\/\/cov-comsec.github.io\/posts\/2021_scanning\/","datePublished":"2021-09-29T22:40:28+01:00","dateModified":"2021-11-04T10:34:36+00:00","publisher":{"@type":"Organization","name":"Jack Orcherton","logo":"https:\/\/cov-comsec.github.io\/CUEH.svg"},"author":{"@type":"Person","name":"Jack Orcherton"},"description":"A brief introduction to scanning tools and techniques, ending the session with a boot2root challenge"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about/>About </a><a class=menu-item href=/galactic/>Galactic CTF </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/schedule/>Schedule </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/galactic/ title>Galactic CTF</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/schedule/ title>Schedule</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Scanning and Enumeration</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://jackorcherton.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>Jack Orcherton</a></span>&nbsp;<span class=post-category>included in <a href=/categories/academic-year-2021-22/><i class="far fa-folder fa-fw"></i>Academic Year 2021-22</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-09-29>2021-09-29</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;726 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#warm-up---getting-help-in-the-terminal>Warm Up - Getting help in the Terminal</a><ul><li><a href=#--help>&ndash;help</a></li><li><a href=#man-pages>Man Pages</a></li></ul></li><li><a href=#scanning>Scanning</a><ul><li><a href=#legal>Legal</a></li><li><a href=#networks-and-why-scan>Networks and Why Scan?</a></li><li><a href=#ports-and-why-scan>Ports and Why Scan?</a><ul><li><a href=#types-of-scan>Types of Scan</a></li></ul></li></ul></li><li><a href=#challenge>Challenge</a></li></ul></nav></div></div><div class=content id=content><p>In this session we will begin to look at scanning and enummeration, and start to look at some of the associated tools.</p><h2 id=warm-up---getting-help-in-the-terminal>Warm Up - Getting help in the Terminal</h2><p>Ever forgotten a command or switch in linux - here&rsquo;s two great ways to find help; all from the comfort of your terminal!</p><h3 id=--help>&ndash;help</h3><p>Virtually all commands in linux have built-in help, all you need to do is append <code>--help</code> to the end of your command. So for help with nmap, you would use</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>nmap --help
</span></span></code></pre></td></tr></table></div></div><p>Now this can produce a lot of text output, so you may wish to add the grep command to filter the output. So for example, I wish to find out how to detect an operating system in a nmap scan</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>nmap --help <span class=p>|</span> grep <span class=s2>&#34;OS &#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=man-pages>Man Pages</h3><p>Man pages, short for manual, is a well manual for a specific command - to use it just type <code>man &lt;command></code>. This will generally display more information the &ndash;help. For example, to view the manual for nmap, type:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>man nmap
</span></span></code></pre></td></tr></table></div></div><p>To search the file press &lsquo;/&rsquo; and then enter your search term.</p><h2 id=scanning>Scanning</h2><ul><li>Scanning is an essential tool in ethical hacking, and great for intelligence gathering.</li><li>Allows us to gain an ‘image’ of what is happening.</li><li>There are multiple types of scanning – Directory, Vulnerability, Network, Port, etc.</li><li>This week we will focus of network and port scanning using Nmap (but please note there are alternatives).</li></ul><h3 id=legal>Legal</h3><p>Scanning is seen as a form of an attack (as there are no other reasons why you would scan a device). This means that if you scan a device you do not have written or prior permission to use you could be convicted under the <strong>Computer Misuse Act 1990</strong>. Advice:</p><ul><li>Only scan IPs that you have prior written permission to scan.</li><li>Only scan private IP’s as defined in RFC 1918.</li><li>When using a VM use host-only networking - as this will prevent you from scanning external IPs.</li></ul><h3 id=networks-and-why-scan>Networks and Why Scan?</h3><p>A network is a group of interconnected computers, which are assigned an IP address. The whole point of scanning a network is to discover which IP addresses are in use across the network (so we can target them in the port scanning phase).
There are a few ways to go about this, each with pro’s and con’s:</p><ul><li>Wire-tap<ul><li>Can be done by plugging a device into the network, or the functionality can be emulated by software like wireshark</li><li>Records each packet that passes it</li><li>Main advantage to this method it is quiet, hence useful for red teaming situations</li><li>Main disadvantage is that it can be slower and miss devices</li></ul></li><li>ARP Scan<ul><li>The Address Resolution Protocol is used to find the MAC address of a computer on a local subnet</li><li>Main advantage of ARP is that it cannot be disabled in IPv4 and you can find out the manufacturer of each device</li><li>Main disadvantage is that you can only find devices on your local subnet</li></ul></li><li>Ping Sweep<ul><li>This sends an ICMP request to every device on the network</li><li>If there is a response, a machine is at that address</li><li>As it is a layer 3 protocol, it can reach devices on other subnets (hence finding more)</li><li>Main disadvantage is that more and more devices will not respond to ping requests (so that they will not be discovered), for example this behaviour is blocked by default in Windows 10.</li></ul></li></ul><h3 id=ports-and-why-scan>Ports and Why Scan?</h3><ul><li>Ports are used to separate network traffic between different - applications.</li><li>There are two types of ports TCP & UDP</li><li>There are 65535 & standards define what they normally do:<ul><li>0 – 1023 Well Known</li><li>1024 – 49151 Assigned Ports</li><li>49152 + Dynamic Ports</li></ul></li><li>You can find ports that are open (and not blocked by the firewall)</li><li>You can attempt to determine the software/application running that port and research associated vulnerabilities</li><li>You can try to discover the hosts operating system</li></ul><h4 id=types-of-scan>Types of Scan</h4><ul><li>TCP Stealth Scan - <code>sudo nmap –sS {ip}</code></li><li>TCP Connect Scan - <code>nmap –sT {ip}</code></li><li>Ping Sweep - <code>nmap –sn {ip}</code></li><li>UDP Scan - <code>sudo nmap –sU {ip}</code></li><li>ARP Scan - <code>arp-scan {ip-network}</code></li></ul><h2 id=challenge>Challenge</h2><p>Head to CTFd for this week&rsquo;s challenge and complete the Scanning and Enumeration section.</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Write-Up<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>To view the write-up for this week&rsquo;s challenge, please refer to the Nmap 2 challenge, on <a href=../welcome_nmap_writeup/#nmap-2 rel>this post</a></div></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-11-04&nbsp;<a class=git-hash href=https://github.com/Cov-ComSec/Cov-ComSec.github.io/commit/6a776f65c8e060ead4fc5b3b700bf9b4ee665106 target=_blank title="commit by Jack Orcherton(31766070+jackorcherton@users.noreply.github.com) 6a776f65c8e060ead4fc5b3b700bf9b4ee665106: Removed week 2 name">
<i class="fas fa-hashtag fa-fw"></i>6a776f6</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/2021_scanning/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/nmap/>Nmap</a>,&nbsp;<a href=/tags/ctf/>CTF</a>,&nbsp;<a href=/tags/docker/>Docker</a>,&nbsp;<a href=/tags/enumeration/>enumeration</a>,&nbsp;<a href=/tags/reconnaissance/>reconnaissance</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/week1_writeup/ class=prev rel=prev title="Week 1: OSINT Chalange Writeup"><i class="fas fa-angle-left fa-fw"></i>Week 1: OSINT Chalange Writeup</a>
<a href=/posts/octalkber/ class=next rel=next title=Octalkber>Octalkber<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div>Please ensure all comments adhere to our <strong><a href=/conduct>Code of Conduct!</a></strong><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>CUEH ComSec</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"photon-dark",issueTerm:"pathname",label:"Comments",lightTheme:"github-light",repo:"Cov-ComSec/Cov-ComSec.github.io"}},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>