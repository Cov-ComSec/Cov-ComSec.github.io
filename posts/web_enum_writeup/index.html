<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Web Enumeration Writeup - CUEH ComSec</title><meta name=Description content="The official site of CUEH ComSec - Coventry University's Ethical Hacking Society. Meeting weekly, we plan to use this site to show the progress of the group."><meta property="og:title" content="Web Enumeration Writeup"><meta property="og:description" content="Web Enumeration ctf Start your docker instances and let&rsquo;s hack! 8 flags inside this machine
Every time first thing to do Nmap scan Look at your scan results. So we have one port open 3838/tcp and we have at least one directory &lsquo;/legal&rsquo; and one file robots.txt and the box is running nginx. First thing lets open the browser and navigate to 172.17.0.2 Get a good look at the source code and the style."><meta property="og:type" content="article"><meta property="og:url" content="https://cov-comsec.github.io/posts/web_enum_writeup/"><meta property="og:image" content="https://cov-comsec.github.io/logo.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-28T12:40:28+01:00"><meta property="article:modified_time" content="2021-06-22T12:09:00+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cov-comsec.github.io/logo.svg"><meta name=twitter:title content="Web Enumeration Writeup"><meta name=twitter:description content="Web Enumeration ctf Start your docker instances and let&rsquo;s hack! 8 flags inside this machine
Every time first thing to do Nmap scan Look at your scan results. So we have one port open 3838/tcp and we have at least one directory &lsquo;/legal&rsquo; and one file robots.txt and the box is running nginx. First thing lets open the browser and navigate to 172.17.0.2 Get a good look at the source code and the style."><meta name=application-name content="CUEH ComSec"><meta name=apple-mobile-web-app-title content="CUEH ComSec"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/CUEH.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://cov-comsec.github.io/posts/web_enum_writeup/><link rel=prev href=https://cov-comsec.github.io/posts/web_enum/><link rel=next href=https://cov-comsec.github.io/posts/ziemni/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Web Enumeration Writeup","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/cov-comsec.github.io\/posts\/web_enum_writeup\/"},"image":["https:\/\/cov-comsec.github.io\/CUEH.svg"],"genre":"posts","keywords":"writeup, reconnaissance, enumeration, Nmap, Web Shells","wordcount":548,"url":"https:\/\/cov-comsec.github.io\/posts\/web_enum_writeup\/","datePublished":"2020-10-28T12:40:28+01:00","dateModified":"2021-06-22T12:09:00+01:00","publisher":{"@type":"Organization","name":"Jack Orcherton","logo":"https:\/\/cov-comsec.github.io\/CUEH.svg"},"author":{"@type":"Person","name":"Tiago Pascoal"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about/>About </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/schedule/>Schedule </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="CUEH ComSec"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/CUEH.svg data-srcset="/CUEH.svg, /CUEH.svg 1.5x, /CUEH.svg 2x" data-sizes=auto alt=/CUEH.svg title=/CUEH.svg>ComSec</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/schedule/ title>Schedule</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Web Enumeration Writeup</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Tiago Pascoal</a></span>&nbsp;<span class=post-category>included in <a href=/categories/academic-year-2020-21/><i class="far fa-folder fa-fw"></i>Academic Year 2020-21</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-10-28>2020-10-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;548 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#robotstxt>Robots.txt</a></li><li><a href=#legal>/legal/</a><ul><li><a href=#legalpapers>/legal/papers</a></li></ul></li><li><a href=#404>404</a></li><li><a href=#well-knownsecuritytxt>.well-known/security.txt</a></li><li><a href=#flagtxt>Flag.txt</a></li><li><a href=#wp-content>wp-content</a></li></ul></nav></div></div><div class=content id=content><p>Web Enumeration ctf
Start your docker instances and let&rsquo;s hack!
8 flags inside this machine</p><p>Every time first thing to do Nmap scan
<img class=lazyload src=/svg/loading.min.svg data-src=img/scan.png data-srcset="/posts/web_enum_writeup/img/scan.png, img/scan.png 1.5x, /posts/web_enum_writeup/img/scan.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/scan.png title=scan></p><p>Look at your scan results. So we have one port open 3838/tcp and we have at least one directory &lsquo;/legal&rsquo; and one file robots.txt and the box is running nginx.
First thing lets open the browser and navigate to 172.17.0.2
<img class=lazyload src=/svg/loading.min.svg data-src=img/index.png data-srcset="/posts/web_enum_writeup/img/index.png, img/index.png 1.5x, /posts/web_enum_writeup/img/index.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/index.png title=Homepage>
Get a good look at the source code and the style.css and should be able to find the flag1.
Well this week is all about list and enumerating web apps so let&rsquo;s do it. You have a lot of tools from gobuster, ffuf, dirbuster and etc.
I&rsquo;ll be using dirbuster. Dirbuster is better for recursion.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=img/startingdirbuster.png data-srcset="/posts/web_enum_writeup/img/startingdirbuster.png, img/startingdirbuster.png 1.5x, /posts/web_enum_writeup/img/startingdirbuster.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/startingdirbuster.png title=/posts/web_enum_writeup/img/startingdirbuster.png>
<img class=lazyload src=/svg/loading.min.svg data-src=img/dirbuster.png data-srcset="/posts/web_enum_writeup/img/dirbuster.png, img/dirbuster.png 1.5x, /posts/web_enum_writeup/img/dirbuster.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/dirbuster.png title=/posts/web_enum_writeup/img/dirbuster.png>
Looks like we have a lot more inside this Web App.</p><h2 id=robotstxt>Robots.txt</h2><p>Lets go to robots.txt. Robots.txt is always a good spot to look for flags in ctfs and sometimes u can get information about other directories will you wait for your scans and scripts to end.
You should have one flag2.</p><h2 id=legal>/legal/</h2><p>How boring can we be? Actually is always good to remind you guys we are living in the grey area. Here you have the first 2 sections of the Computer Misuse act 1990. Opens your eyes cause in the middle of all of those words you should be able to find flag3 you just need to loose and 10 secs in cyberchef and one more is done.
<img class=lazyload src=/svg/loading.min.svg data-src=img/legal.png data-srcset="/posts/web_enum_writeup/img/legal.png, img/legal.png 1.5x, /posts/web_enum_writeup/img/legal.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/legal.png title=/posts/web_enum_writeup/img/legal.png></p><h3 id=legalpapers>/legal/papers</h3><p>Hm how good are you at web dev? Do you guys know which tags you can use while inserting an image?
Do you what the alt tag does?
If you don&rsquo;t while do a brief explanation. So inside the alt=&rsquo;&rsquo; tag you will have alternate text that will be shown when the image cannot be displayed. Look at the alt tag for this image and flag4 is done.</p><h2 id=404>404</h2><p>404 is a page that can be really important for the attacker if not well setup. From the 404 page we can sometimes extract important information for example the version of the distro or server ,etc. This kinds of information can be really important sometimes to find CVES and other vulns.
By the way, always check the source code.
<img class=lazyload src=/svg/loading.min.svg data-src=img/404.png data-srcset="/posts/web_enum_writeup/img/404.png, img/404.png 1.5x, /posts/web_enum_writeup/img/404.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/404.png title=/posts/web_enum_writeup/img/404.png></p><h2 id=well-knownsecuritytxt>.well-known/security.txt</h2><p>Have you heard of this directory before? If you haven&rsquo;t you can read about it <a href=https://en.wikipedia.org/wiki/Security.txt target=_blank rel="noopener noreffer">here</a>{target=_blank}. Always good to check.</p><h2 id=flagtxt>Flag.txt</h2><p>Looks like we can&rsquo;t see this file maybe after getting our reverse shell we will be able to.
<img class=lazyload src=/svg/loading.min.svg data-src=img/flag_txt.png data-srcset="/posts/web_enum_writeup/img/flag_txt.png, img/flag_txt.png 1.5x, /posts/web_enum_writeup/img/flag_txt.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/flag_txt.png title=/posts/web_enum_writeup/img/flag_txt.png></p><h2 id=wp-content>wp-content</h2><p>Let&rsquo;s go back to the dirbuster scan, you have a page called wp-content. For the people that don&rsquo;t know this is the standard page for uploading files in wordpress. Get your reverse shells from pentestmonkeys upload the file. It will appear as a link in the same page. Before clicking it, run your netcat in the terminal
<img class=lazyload src=/svg/loading.min.svg data-src=img/reversein.png data-srcset="/posts/web_enum_writeup/img/reversein.png, img/reversein.png 1.5x, /posts/web_enum_writeup/img/reversein.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/reversein.png title=/posts/web_enum_writeup/img/reversein.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nc -lvnp 1234
</span></span></code></pre></td></tr></table></div></div><p>Go back to the browser and click the file and you should have the tty.</p><p>Navigate to /var/www/ and cat the flag.txt
Flag7 only one left.
Let&rsquo;s get root.
So without using any script lets enumerate the SUID permissions using</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>find / -perm /4000 2&gt;/dev/null
</span></span></code></pre></td></tr></table></div></div><p>Looks like we can run sudo.
Lets look for the permissions.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo -l
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=img/privesc.png data-srcset="/posts/web_enum_writeup/img/privesc.png, img/privesc.png 1.5x, /posts/web_enum_writeup/img/privesc.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/privesc.png title=/posts/web_enum_writeup/img/privesc.png>
If you do id now you will be able to see you are root.
<img class=lazyload src=/svg/loading.min.svg data-src=img/rooted.png data-srcset="/posts/web_enum_writeup/img/rooted.png, img/rooted.png 1.5x, /posts/web_enum_writeup/img/rooted.png 2x" data-sizes=auto alt=/posts/web_enum_writeup/img/rooted.png title=/posts/web_enum_writeup/img/rooted.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cat /root/flag.txt
</span></span></code></pre></td></tr></table></div></div><p>Done Congrats!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-06-22&nbsp;<a class=git-hash href=https://github.com/Cov-ComSec/Cov-ComSec.github.io/commit/7a17d3da21d05c229d6dc88795865bdcc9436e57 target=_blank title="commit by Jack Orcherton(jackorcherton@outlook.com) 7a17d3da21d05c229d6dc88795865bdcc9436e57: SPaG Check">
<i class="fas fa-hashtag fa-fw"></i>7a17d3d</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/web_enum_writeup/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/writeup/>writeup</a>,&nbsp;<a href=/tags/reconnaissance/>reconnaissance</a>,&nbsp;<a href=/tags/enumeration/>enumeration</a>,&nbsp;<a href=/tags/nmap/>Nmap</a>,&nbsp;<a href=/tags/web-shells/>Web Shells</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/web_enum/ class=prev rel=prev title="Web Enumeration"><i class="fas fa-angle-left fa-fw"></i>Web Enumeration</a>
<a href=/posts/ziemni/ class=next rel=next title="Graduate Talks - Ziemni">Graduate Talks - Ziemni<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div>Please ensure all comments adhere to our <strong><a href=/conduct>Code of Conduct!</a></strong><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>CUEH ComSec</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"photon-dark",issueTerm:"pathname",label:"Comments",lightTheme:"github-light",repo:"Cov-ComSec/Cov-ComSec.github.io"}},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>